<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CU CGPA Calculator | Official Evaluation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --cherry-red: #9B1C31;
            --cherry-red-dark: #7D1627;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fcfcfc;
            color: #1f2937;
        }
        .animate-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239B1C31' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 1.2em 1.2em;
        }
        .cherry-gradient {
            background: linear-gradient(135deg, var(--cherry-red) 0%, var(--cherry-red-dark) 100%);
        }
        .cherry-text { color: var(--cherry-red); }
        .cherry-border-focus:focus {
            border-color: var(--cherry-red) !important;
            box-shadow: 0 0 0 3px rgba(155, 28, 49, 0.1);
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--cherry-red); }
    </style>
</head>
<body class="min-h-screen flex flex-col pb-12">
    <!-- Header -->
    <header class="cherry-gradient text-white py-8 px-4 shadow-xl">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="bg-white p-3 rounded-2xl shadow-lg">
                    <i class="fa-solid fa-graduation-cap text-[#9B1C31] text-3xl"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-black tracking-tight leading-none">CGPA Calculator</h1>
                    <p class="text-[11px] opacity-80 uppercase tracking-[0.3em] font-bold mt-2">Chandigarh University</p>
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-4xl w-full mx-auto px-4 mt-10">
        <!-- Tab Switcher -->
        <div class="bg-white p-1.5 rounded-2xl shadow-sm border border-gray-100 flex mb-10 overflow-hidden">
            <button id="sgpa-tab" onclick="setMode('SGPA')" class="flex-1 py-4 px-6 rounded-xl font-black text-xs tracking-widest transition-all duration-300 bg-[#9B1C31] text-white shadow-lg">
                SGPA MODE
            </button>
            <button id="cgpa-tab" onclick="setMode('CGPA')" class="flex-1 py-4 px-6 rounded-xl font-black text-xs tracking-widest transition-all duration-300 text-gray-400 hover:text-gray-600 hover:bg-gray-50">
                CGPA MODE
            </button>
        </div>

        <!-- Dynamic Form -->
        <div class="bg-white rounded-[2.5rem] shadow-sm border border-gray-100 p-8 md:p-12 relative overflow-hidden">
            <div class="flex items-center justify-between mb-10">
                <h2 id="section-title" class="text-2xl font-black text-gray-800 flex items-center gap-4">
                    <i class="fa-solid fa-book-open cherry-text"></i>
                    Subject Breakdown
                </h2>
                <button onclick="resetAll()" class="text-[10px] font-black tracking-widest text-red-500 hover:text-red-700 hover:bg-red-50 px-4 py-2 rounded-xl transition-all flex items-center gap-2 border border-red-100 uppercase">
                    <i class="fa-solid fa-rotate-left"></i> Reset
                </button>
            </div>

            <div id="input-rows" class="space-y-6">
                <!-- Rows injected here by JavaScript -->
            </div>

            <button onclick="addRow()" class="w-full mt-8 py-5 border-2 border-dashed border-gray-100 rounded-[1.5rem] text-gray-400 font-bold text-sm hover:border-[#9B1C31] hover:text-[#9B1C31] hover:bg-red-50 transition-all flex items-center justify-center gap-3 group">
                <i class="fa-solid fa-plus-circle group-hover:scale-125 transition-transform text-lg"></i> 
                <span id="add-btn-label" class="uppercase tracking-widest text-xs">Add Row</span>
            </button>

            <div class="mt-14 pt-10 border-t border-gray-50">
                <button onclick="calculate()" class="w-full cherry-gradient hover:opacity-95 text-white py-6 rounded-[1.5rem] font-black text-xl tracking-[0.15em] shadow-2xl hover:shadow-cherry-red/20 transition-all active:scale-[0.97] flex items-center justify-center gap-5 uppercase">
                    <span id="calc-btn-label">Calculate SGPA</span>
                    <i class="fa-solid fa-bolt-lightning text-yellow-400"></i>
                </button>
            </div>
        </div>

        <!-- Result Card -->
        <div id="result-view" class="hidden">
            <!-- Results injected here -->
        </div>

        <!-- Policy & Grading Reference -->
        <div class="mt-16 grid md:grid-cols-2 gap-8">
            <div class="bg-white p-8 rounded-[2rem] border border-gray-100 shadow-sm">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-10 h-10 rounded-2xl bg-red-50 flex items-center justify-center shadow-inner">
                        <i class="fa-solid fa-table-list cherry-text"></i>
                    </div>
                    <h4 class="font-black text-gray-800 tracking-tight text-lg">CU Grading System</h4>
                </div>
                <div class="grid grid-cols-4 gap-3" id="grade-legend">
                    <!-- JS populated -->
                </div>
            </div>

            <div class="bg-white p-8 rounded-[2rem] border border-gray-100 shadow-sm">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-10 h-10 rounded-2xl bg-red-50 flex items-center justify-center shadow-inner">
                        <i class="fa-solid fa-circle-info cherry-text"></i>
                    </div>
                    <h4 class="font-black text-gray-800 tracking-tight text-lg">Performance Matrix</h4>
                </div>
                <div class="space-y-3.5 text-sm font-bold">
                    <div class="flex items-center justify-between text-gray-500 border-b border-gray-50 pb-2.5">
                        <span class="tracking-wide">â‰¥ 9.00</span>
                        <span class="text-green-600 uppercase tracking-widest text-xs">Excellent</span>
                    </div>
                    <div class="flex items-center justify-between text-gray-500 border-b border-gray-50 pb-2.5">
                        <span class="tracking-wide">8.00 - 8.99</span>
                        <span class="text-blue-600 uppercase tracking-widest text-xs">Very Good</span>
                    </div>
                    <div class="flex items-center justify-between text-gray-500 border-b border-gray-50 pb-2.5">
                        <span class="tracking-wide">7.00 - 7.99</span>
                        <span class="text-indigo-600 uppercase tracking-widest text-xs">Good</span>
                    </div>
                    <div class="flex items-center justify-between text-gray-500 border-b border-gray-50 pb-2.5">
                        <span class="tracking-wide">6.00 - 6.99</span>
                        <span class="text-yellow-600 uppercase tracking-widest text-xs">Average</span>
                    </div>
                    <div class="flex items-center justify-between text-gray-500">
                        <span class="tracking-wide">&lt; 6.00</span>
                        <span class="text-red-500 uppercase tracking-widest text-xs">Needs Improvement</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-auto py-12 text-center text-gray-400 text-[10px] font-black tracking-[0.3em] uppercase">
        <p>Not an official CU application</p>
        <div class="w-10 h-1 bg-gray-100 mx-auto my-4 rounded-full"></div>
        <p class="opacity-50">CU Evaluation Policy Compliant</p>
    </footer>

    <script>
        const GRADES = {
            'O': 10, 'A+': 9, 'A': 8, 'B+': 7, 'B': 6, 'C': 5, 'P': 4, 'F': 0
        };

        let currentMode = 'SGPA';
        let items = [];

        function init() {
            setMode('SGPA');
            renderLegend();
        }

        function setMode(mode) {
            currentMode = mode;
            const sgpaTab = document.getElementById('sgpa-tab');
            const cgpaTab = document.getElementById('cgpa-tab');
            
            if (mode === 'SGPA') {
                sgpaTab.className = "flex-1 py-4 px-6 rounded-xl font-black text-xs tracking-widest transition-all duration-300 bg-[#9B1C31] text-white shadow-lg";
                cgpaTab.className = "flex-1 py-4 px-6 rounded-xl font-black text-xs tracking-widest transition-all duration-300 text-gray-400 hover:text-gray-600 hover:bg-gray-50";
                document.getElementById('section-title').innerHTML = '<i class="fa-solid fa-book-open cherry-text"></i> Subject Breakdown';
                document.getElementById('add-btn-label').innerText = 'Add Subject Row';
                document.getElementById('calc-btn-label').innerText = 'Calculate SGPA';
            } else {
                cgpaTab.className = "flex-1 py-4 px-6 rounded-xl font-black text-xs tracking-widest transition-all duration-300 bg-[#9B1C31] text-white shadow-lg";
                sgpaTab.className = "flex-1 py-4 px-6 rounded-xl font-black text-xs tracking-widest transition-all duration-300 text-gray-400 hover:text-gray-600 hover:bg-gray-50";
                document.getElementById('section-title').innerHTML = '<i class="fa-solid fa-graduation-cap cherry-text"></i> Semester History';
                document.getElementById('add-btn-label').innerText = 'Add Semester Row';
                document.getElementById('calc-btn-label').innerText = 'Calculate CGPA';
            }

            resetAll();
        }

        function resetAll() {
            items = [];
            document.getElementById('result-view').classList.add('hidden');
            // Starting with only ONE row by default as per user request
            addRow(); 
            renderRows();
        }

        function addRow() {
            const id = Date.now() + Math.random();
            const newItem = currentMode === 'SGPA' 
                ? { id, name: '', credits: '', grade: 'O' }
                : { id, name: `Sem ${items.length + 1}`, credits: '', sgpa: '' };
            items.push(newItem);
            renderRows();
        }

        function removeRow(id) {
            if (items.length > 1) {
                items = items.filter(item => item.id !== id);
                renderRows();
            }
        }

        function updateValue(id, field, value) {
            const item = items.find(i => i.id === id);
            if (item) item[field] = value;
        }

        function renderRows() {
            const container = document.getElementById('input-rows');
            container.innerHTML = items.map((item, index) => {
                const label1 = currentMode === 'SGPA' ? 'Subject Name' : 'Semester Name';
                const label2 = currentMode === 'SGPA' ? 'Credits' : 'SGPA Obtained';
                const label3 = currentMode === 'SGPA' ? 'Grade' : 'Credits';

                const input1 = `<input type="text" placeholder="${currentMode === 'SGPA' ? 'e.g. OS' : 'e.g. Sem 1'}" value="${item.name}" oninput="updateValue(${item.id}, 'name', this.value)" class="w-full bg-gray-50 border border-gray-100 rounded-xl px-4 py-3 text-sm font-bold text-gray-800 transition-all outline-none cherry-border-focus">`;
                
                let input2, input3;

                if (currentMode === 'SGPA') {
                    input2 = `<input type="number" placeholder="4" min="1" max="20" step="0.5" value="${item.credits}" oninput="updateValue(${item.id}, 'credits', this.value)" class="w-full bg-gray-50 border border-gray-100 rounded-xl px-4 py-3 text-sm font-black text-gray-800 transition-all outline-none cherry-border-focus">`;
                    input3 = `<select onchange="updateValue(${item.id}, 'grade', this.value)" class="w-full bg-gray-50 border border-gray-100 rounded-xl px-4 py-3 text-sm font-black cherry-text transition-all outline-none cursor-pointer">
                        ${Object.keys(GRADES).map(g => `<option value="${g}" ${item.grade === g ? 'selected' : ''}>${g}</option>`).join('')}
                    </select>`;
                } else {
                    input2 = `<input type="number" placeholder="9.0" min="0" max="10" step="0.01" value="${item.sgpa}" oninput="updateValue(${item.id}, 'sgpa', this.value)" class="w-full bg-gray-50 border border-gray-100 rounded-xl px-4 py-3 text-sm font-black cherry-text transition-all outline-none cherry-border-focus">`;
                    input3 = `<input type="number" placeholder="24" min="1" max="50" step="1" value="${item.credits}" oninput="updateValue(${item.id}, 'credits', this.value)" class="w-full bg-gray-50 border border-gray-100 rounded-xl px-4 py-3 text-sm font-black text-gray-800 transition-all outline-none cherry-border-focus">`;
                }

                return `
                <div class="grid grid-cols-12 gap-4 items-end animate-in">
                    <div class="col-span-1 text-[10px] font-black text-gray-200 pb-4 text-center">${index + 1}</div>
                    <div class="col-span-5 md:col-span-6">
                        <label class="text-[9px] font-black text-gray-400 uppercase tracking-[0.2em] mb-2 block">${label1}</label>
                        ${input1}
                    </div>
                    <div class="col-span-3 md:col-span-2">
                        <label class="text-[9px] font-black text-gray-400 uppercase tracking-[0.2em] mb-2 block">${label2}</label>
                        ${input2}
                    </div>
                    <div class="col-span-2 md:col-span-2">
                        <label class="text-[9px] font-black text-gray-400 uppercase tracking-[0.2em] mb-2 block">${label3}</label>
                        ${input3}
                    </div>
                    <div class="col-span-1 flex justify-center pb-2.5">
                        <button onclick="removeRow(${item.id})" class="text-gray-300 hover:text-red-500 transition-all p-2 hover:bg-red-50 rounded-lg">
                            <i class="fa-solid fa-trash-can text-sm"></i>
                        </button>
                    </div>
                </div>`;
            }).join('');
        }

        function calculate() {
            let totalCredits = 0;
            let totalWeightedPoints = 0;
            let isValid = true;
            let rowCount = 0;

            for (const item of items) {
                const credits = parseFloat(item.credits);
                if (isNaN(credits) || credits <= 0) continue;

                rowCount++;
                if (currentMode === 'SGPA') {
                    totalWeightedPoints += GRADES[item.grade] * credits;
                    totalCredits += credits;
                } else {
                    const sgpa = parseFloat(item.sgpa);
                    if (isNaN(sgpa) || sgpa < 0 || sgpa > 10) {
                        isValid = false;
                        break;
                    }
                    totalWeightedPoints += sgpa * credits;
                    totalCredits += credits;
                }
            }

            if (rowCount === 0) {
                alert(`Please enter details for at least one row.`);
                return;
            }

            if (totalCredits === 0 || !isValid) {
                alert(`Please enter valid numerical values for all ${currentMode} rows.`);
                return;
            }

            const score = totalWeightedPoints / totalCredits;
            renderResult(score, totalCredits);
        }

        function getRemark(score) {
            if (score >= 9.0) return { text: 'Excellent', color: 'text-green-600', icon: 'fa-crown' };
            if (score >= 8.0) return { text: 'Very Good', color: 'text-blue-600', icon: 'fa-award' };
            if (score >= 7.0) return { text: 'Good', color: 'text-indigo-600', icon: 'fa-thumbs-up' };
            if (score >= 6.0) return { text: 'Average', color: 'text-yellow-600', icon: 'fa-check' };
            return { text: 'Needs Improvement', color: 'text-red-500', icon: 'fa-triangle-exclamation' };
        }

        function renderResult(score, credits) {
            const { text, color, icon } = getRemark(score);
            const view = document.getElementById('result-view');
            view.classList.remove('hidden');

            view.innerHTML = `
            <div class="bg-white rounded-[3rem] shadow-2xl border border-gray-100 overflow-hidden mt-12 animate-in">
                <div class="cherry-gradient px-10 py-6 flex items-center justify-between">
                    <span class="text-white font-black uppercase tracking-[0.4em] text-[10px]">Evaluation Result</span>
                    <i class="fa-solid fa-certificate text-white/30 text-xl"></i>
                </div>
                <div class="p-12">
                    <div class="flex flex-col md:flex-row items-center gap-16">
                        <div class="text-center md:flex-1">
                            <h4 class="text-gray-400 font-black uppercase tracking-[0.3em] text-[9px] mb-4">Calculated ${currentMode}</h4>
                            <div class="text-8xl font-black ${color} tracking-tighter tabular-nums mb-6 drop-shadow-sm">
                                ${score.toFixed(2)}
                            </div>
                            <div class="inline-flex items-center gap-3 px-6 py-3 bg-gray-50 rounded-full border border-gray-100">
                                <i class="fa-solid ${icon} ${color} text-sm"></i>
                                <span class="font-black ${color} uppercase text-[10px] tracking-[0.2em]">${text}</span>
                            </div>
                        </div>
                        <div class="w-full md:w-auto md:min-w-[250px] space-y-8 border-t md:border-t-0 md:border-l border-gray-100 pt-10 md:pt-0 md:pl-16">
                            <div>
                                <p class="text-[9px] font-black text-gray-400 uppercase tracking-[0.25em] mb-2">Total Earned Credits</p>
                                <p class="text-3xl font-black text-gray-800">${credits}</p>
                            </div>
                            <div>
                                <p class="text-[9px] font-black text-gray-400 uppercase tracking-[0.25em] mb-2">Max Scale</p>
                                <p class="text-3xl font-black text-gray-800">10.00</p>
                            </div>
                            <div class="pt-2">
                                <div class="h-2 w-full bg-gray-100 rounded-full overflow-hidden shadow-inner">
                                    <div class="h-full cherry-gradient transition-all duration-1000 ease-out" style="width: ${score * 10}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;

            window.scrollTo({ top: view.offsetTop - 60, behavior: 'smooth' });
        }

        function renderLegend() {
            const container = document.getElementById('grade-legend');
            container.innerHTML = Object.entries(GRADES).map(([g, p]) => `
                <div class="bg-gray-50 p-3.5 rounded-2xl border border-gray-100 text-center hover:border-[#9B1C31] transition-colors group">
                    <div class="text-[10px] font-black text-gray-400 mb-1 group-hover:text-[#9B1C31] transition-colors">${g}</div>
                    <div class="text-lg font-black text-gray-800">${p}</div>
                </div>
            `).join('');
        }

        window.onload = init;
    </script>
</body>
</html>
